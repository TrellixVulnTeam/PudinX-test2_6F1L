# Import base streamlit dependency
import streamlit as st
# Import pandas to load the analytics data
import pandas as pd
# Import subprocess to run tiktok script from command line
from subprocess import call
# Import plotly for viz
import plotly.express as px
from TikTokApi import TikTokApi as tiktok
import time as time 
import datetime
# Set page width to wide
st.set_page_config(layout='wide')

# Create sidebar
st.sidebar.markdown("<div><img src='data:image/jpeg;base64,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' width=100 /><h1 style='display:inline-block'>Tiktok Analytics</h1></div>", unsafe_allow_html=True)
st.sidebar.markdown("This is my test-2 results for PundiX.")
st.sidebar.markdown("To initiate <ol><li>Enter a input<i>#hashtag</i> you wish to analyse</li> <li>Hit <i>Search</i>.</li> <li>You are able to zoom in on the graph to obtain daily statistics</li></ol>",unsafe_allow_html=True)

# Input 
hashtag = st.text_input('Search for a hashtag here', value="")

# Button
if st.button('Search'):
    # Run get data function here

    call(['python', 'Data_Scrapping.py', hashtag])
    # Load in existing data to test it out
    df = pd.read_csv('Export_Data.csv')
    
    
    # Plotly viz here
    fig = px.histogram(df, x='createTime', hover_data=['desc'], y='stats_diggCount', height=300) 
    st.plotly_chart(fig, use_container_width=True)
    # Show tabular dataframe in streamlit
    df